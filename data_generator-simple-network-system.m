clear; clc;

%% Define state-space parameters
syms s L c d Io Vs Vc Il rc rl

A1 = [-rl/L 0; 0 0];
A2 = [-(rl+rc)/L -1/L; 1/c 0];
B11 = [0; -1/c];
B12 = [1/L; 0];
B21 = [rc/L; -1/c];
B22 = [1/L; 0];
C1 = [0 1];
C2 = [rc 1];
E1 = -rc;
E2 = -rc;

%% Averaged matrices
A = A1*d + A2*(1-d);
B1 = B11*d + B21*(1-d);
B2 = B12*d + B22*(1-d);
C = C1*d + C2*(1-d);
E = E1*d + E2*(1-d);
I = eye(size(A));

% %% Small-signal dc-link voltage for nonlinear boost converter
% vdc_s = (C*inv(s*I-A)*((A1-A2)*[Il; Vc]+(B11-B21)*Io+(B12-B22)*Vs) ...
%     +(C1-C2)*[Il;Vc]+(E1-E2)*Io)*d_s+(C*inv(s*I-A)*B1+E)*io_s+C*inv(s*I-A)*B2*vs_s;

% %% Transfer Function - vdc(s)/d(s) - assuming io_s=0 and vs_s=0
% vdcs_by_ds = (C*inv(s*I-A)*((A1-A2)*[Il; Vc]+(B11-B21)*Io+(B12-B22)*Vs) ...
%     +(C1-C2)*[Il;Vc]+(E1-E2)*Io);
% pretty(vdcs_by_ds)

%% Transfer Function - vdc(s)/d(s) - assuming io_s=0 and vs_s=0
vo_by_io = -((C*(inv(s*I-A))*B1) + E);
[n, d] = numden(collect(vo_by_io));
pretty(simplify(vo_by_io))

%% Equivalent impedance as seen from Source-1
syms R_load1 L_load1 R_load2 L_load2
syms R_ll1 L_ll1 R_ll2 L_ll2 R_ll3 L_ll3 R_ll4 L_ll4

% Load impedances
zL1 = R_load1+s*L_load1;
zL2 = R_load2+s*L_load2;
zS2 = vo_by_io;

% Line Impedances
z1 = R_ll1+s*L_ll1;     % Observer Line
z2 = R_ll2+s*L_ll2;     % Load1 Line
z3 = R_ll3+s*L_ll3;     % PV Line
z4 = R_ll4+s*L_ll4;     % Load2 Line

za = 2*z2+zL1;
zb = 2*z3+zS2;
zc = 2*z4+zL2;

z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);

Z_net = 2*z1 + z_eq;
pretty(Z_net)

%% Values substitutions
L=500e-6; c=200e-6; rl=1e-3; rc=1e-3;
R_load1s=linspace(2,8,5);
L_load1s=linspace(100,200,5)*1e-6;
R_load2s=linspace(2,8,5); 
L_load2s=linspace(100,200,5)*1e-6;

R_ll1=10e-2; L_ll1=10e-6;
R_ll2=20e-2; L_ll2=20e-6;
R_ll3=30e-2; L_ll3=30e-6;
R_ll4=40e-2; L_ll4=40e-6;

% Fault location and type
fault_location = ["S2","L1","L2","BL"];
fault_type     = ["SC","OC"];
D = [0.3, 0.4, 0.5, 0.6, 0.7];

k = 0;
l = 0;
w = logspace(1,5,100);

%% Non-faulty conditions
total_itr=length(D)*length(R_load1s)*length(R_load2s);
for h=1:length(D)
    d = D(h);
    for i=1:length(R_load1s)
        R_load1 = R_load1s(i);
        L_load1 = L_load1s(i);
        for j=1:length(R_load2s)
            k = k + 1;
            fprintf('Loop: %d/%d\n',k,total_itr);
            R_load2 = R_load2s(j);
            L_load2 = L_load2s(j);

            y = subs(Z_net);
            [nf, df] = numden(y);
            tfn = sym2poly(nf);
            tfd = sym2poly(df);

            sys = tf(tfn, tfd);
            [mag,phase,wout] = bode(sys,w);
            myArr{1,k} = 20*log(reshape(mag, length(mag),1));
            myArr{2,k} = reshape(phase, length(phase), 1);
            myArr{3,k} = wout;
            myArr{4,k} = d;
            myArr{5,k} = R_load1;
            myArr{6,k} = L_load1*1e6;
            myArr{7,k} = R_load2;
            myArr{8,k} = L_load2*1e6;
            myArr{9,k} = "healthy";
            myArr{10,k} = "NA";
            myArr{11,k} = "NA";
        end
    end
end
healthy_cases = k;

%% Healthy data
freq_arr = transpose(myArr{3,1});
mag_mat   = zeros(length(w),healthy_cases);
phase_mat = zeros(length(w),healthy_cases);
final_data = zeros(healthy_cases, 2*length(w)+8);
d_arr = zeros(healthy_cases,1);
R1_arr = zeros(healthy_cases,1);
L1_arr = zeros(healthy_cases,1);
R2_arr = zeros(healthy_cases,1);
L2_arr = zeros(healthy_cases,1);
health_arr = zeros(healthy_cases,1);
fL_arr = zeros(healthy_cases,1);
fT_arr = zeros(healthy_cases,1);

for m=1:healthy_cases
    mag_mat(:,m)    = myArr{1,m};
    phase_mat(:,m)  = myArr{2,m};
    d_arr(m)        = myArr{4,m};
    R1_arr(m)       = myArr{5,m};
    L1_arr(m)       = myArr{6,m};
    R2_arr(m)       = myArr{7,m};
    L2_arr(m)       = myArr{8,m};
    health_arr(m)   = myArr{9,m};
    fL_arr(m)       = myArr{10,m};
    fT_arr(m)       = myArr{11,m};
end

mag_mat = transpose(mag_mat);
phase_mat = transpose(phase_mat);

% creating final data file
final_data(:,1:100) = mag_mat;
final_data(:,101:200) = phase_mat;
final_data(:,201:208) = [d_arr R1_arr L1_arr R2_arr L2_arr health_arr fL_arr fT_arr];

dataFile = 'Hdata_new.xlsx';
writematrix(freq_arr,dataFile,'Sheet','Freq');
writematrix(mag_mat,dataFile,'Sheet','Magnitude');
writematrix(phase_mat,dataFile,'Sheet','Phase');
writematrix(d_arr, dataFile,'Sheet','d2');
writematrix(R1_arr,dataFile,'Sheet','R1');
writematrix(L1_arr,dataFile,'Sheet','L1');
writematrix(R2_arr,dataFile,'Sheet','R2');
writematrix(L2_arr,dataFile,'Sheet','L2');
writematrix(final_data,dataFile,'Sheet','final_data');
T = cell2table(myArr(9:11,:));
writetable(T, 'Hdata_health_new.csv');
fprintf('Healthy data saved as CSV file.\n')

%% Faulty conditions
total_itr=length(D)*length(R_load1s)*length(R_load2s)*length(fault_location)*length(fault_type);
for h=1:length(D)
    d = D(h);
    for i=1:length(R_load1s)
        R_load1 = R_load1s(i);
        L_load1 = L_load1s(i);
        for j=1:length(R_load2s)
            R_load2 = R_load2s(j);
            L_load2 = L_load2s(j);

            for loc=1:length(fault_location)
                % Reset previous information
                zL1 = R_load1+s*L_load1;
                zL2 = R_load2+s*L_load2;
                zS2 = vo_by_io;
                
                za = 2*z2+zL1;
                zb = 2*z3+zS2;
                zc = 2*z4+zL2;
            
                location = fault_location(loc);    
                for ft=1:length(fault_type)
                    l = l + 1;
                    fprintf('Loop: %d/%d\n',l,total_itr);
                    type = fault_type(ft);
            
                    switch location
                        case 'S2'
                            if type=='SC'       % short-circuit at Source2
                                %disp('[INFO]: SC fault in Source2')
                                zS2 = 0;
                                zb = 2*z3+zS2;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            elseif type=='OC'   % open-circuit at Source2
                                %disp('[INFO]: OC fault in Source2')
                                zb = 0;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            end
                        case 'L1'
                            if type=='SC' % short-circuit at Load1
                                %disp('[INFO]: SC fault in Load1')
                                zL1 = 0;
                                za = 2*z2+zL1;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            elseif type=='OC'   % open-circuit at Load1
                                %disp('[INFO]: OC fault in Load1')
                                za = 0;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            end
                        case 'L2'
                            if type=='SC' % short-circuit at Load2
                                %disp('[INFO]: SC fault in Load2')
                                zL2 = 0;
                                zc = 2*z4+zL2;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            elseif type=='OC'   % open-circuit at Load2
                                %disp('[INFO]: OC fault in Load2')
                                zc = 0;
                                z_eq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
                            end
                        case 'BL'
                            if type=='SC' % short-circuit at Bus-Line
                                %disp('[INFO]: SC fault in Bus-line')
                                z_eq = 0;
                            elseif type=='OC'   % open-circuit at Bus-line
                                %disp('[INFO]: OC fault in Bus-line')
                                z_eq = za; 
                            end
                        otherwise
                            disp('[INFO]: Healthy condition')
                            %[za, zb, zc] = non_faulty();
                    end
            
                    Z_net = 2*z1 + z_eq;
                    y = subs(Z_net);
                    
                    [nf, df] = numden(y);
                    tfn = sym2poly(nf);
                    tfd = sym2poly(df);
                    
                    sys = tf(tfn, tfd);
            
                    [mag,phase,wout] = bode(sys,w);
                    faultArr{1,l} = 20*log(reshape(mag, length(mag),1));
                    faultArr{2,l} = reshape(phase, length(phase), 1);
                    faultArr{3,l} = wout;
                    faultArr{4,l} = d;
                    faultArr{5,l} = R_load1;
                    faultArr{6,l} = L_load1*1e6;
                    faultArr{7,l} = R_load2;
                    faultArr{8,l} = L_load2*1e6;
                    faultArr{9,l} = "faulty";
                    faultArr{10,l} = location;
                    faultArr{11,l}= type; 
                end
            end
        end
    end
end
faulty_cases = l;

%% Faulty data
freq_arr = transpose(faultArr{3,1});
mag_mat   = zeros(length(w),faulty_cases);
phase_mat = zeros(length(w),faulty_cases);
final_data = zeros(faulty_cases, 2*length(w)+5);

d_arr = zeros(faulty_cases,1);
R1_arr = zeros(faulty_cases,1);
L1_arr = zeros(faulty_cases,1);
R2_arr = zeros(faulty_cases,1);
L2_arr = zeros(faulty_cases,1);
health_arr = zeros(faulty_cases,1);
faultLoc_arr = zeros(faulty_cases,1);
faultType_arr = zeros(faulty_cases,1);

for n=1:faulty_cases
    mag_mat(:,n)   = faultArr{1,n};
    phase_mat(:,n) = faultArr{2,n};
    d_arr(n) = faultArr{4,n};
    R1_arr(n) = faultArr{5,n};
    L1_arr(n) = faultArr{6,n};
    R2_arr(n) = faultArr{7,n};
    L2_arr(n) = faultArr{8,n};
    health_arr(n) = faultArr{9,n};
    faultLoc_arr(n) = faultArr{10,n};
    faultType_arr(n) = faultArr{11,n};
end

mag_mat = transpose(mag_mat);
phase_mat = transpose(phase_mat);

% creating final data file
final_data(:,1:100) = mag_mat;
final_data(:,101:200) = phase_mat;
final_data(:,201:208) = [d_arr R1_arr L1_arr R2_arr L2_arr health_arr faultLoc_arr faultType_arr];

dataFile = 'Fdata.xlsx';
writematrix(freq_arr,dataFile,'Sheet','Freq');
writematrix(mag_mat,dataFile,'Sheet','Magnitude');
writematrix(phase_mat,dataFile,'Sheet','Phase');
writematrix(d_arr, dataFile,'Sheet','d2');
writematrix(R1_arr,dataFile,'Sheet','R1');
writematrix(L1_arr,dataFile,'Sheet','L1');
writematrix(R2_arr,dataFile,'Sheet','R2');
writematrix(L2_arr,dataFile,'Sheet','L2');
writematrix(final_data,dataFile,'Sheet','final_data');

faultLoc_arr = cell2table(faultArr(10,:));
faultType_arr = cell2table(faultArr(11  ,:));
% T2 = [faultLoc_arr; faultType_arr];
% writetable(T2, 'Fdata_health.csv');
T2 = cell2table(faultArr(9:11,:));
writetable(T2, 'Fdata_health.csv');

%% Data to train Classifier-1 (CLF1)
healthy_cases = k;      % k=125
faulty_cases = l;       % l=1000
total_cases = healthy_cases+faulty_cases;
ID_CLF1 = randperm(total_cases);
train_samplesCLF1 = 1:round(0.8*total_cases);
test_samplesCLF1 = round(0.8*total_cases)+1:total_cases;        

[numDataCLF1, txtDataCLF1, rawDataCLF1] = xlsread('PHM_Final_Data4.xlsx','final_data');
bodeDataCLF1 = normalize(numDataCLF1);
[bode_std, bode_mean] = std(numDataCLF1);
std_trainCLF1 = bode_std(:,1:200);
mean_trainCLF1 = bode_mean(:,1:200);

trainCLF1_X = bodeDataCLF1(ID_CLF1(train_samplesCLF1),1:200);
trainCLF1_y = txtDataCLF1(ID_CLF1(train_samplesCLF1),1);
testCLF1_X = bodeDataCLF1(ID_CLF1(test_samplesCLF1),1:200);
testCLF1_y = txtDataCLF1(ID_CLF1(test_samplesCLF1),1);

%% Data to train Regressor-1
healthy_cases = 125;
% ID_REG = randperm(healthy_cases);
train_samplesReg = 1:round(0.8*healthy_cases);
test_samplesReg = round(0.8*healthy_cases)+1:healthy_cases;        

[numDataReg, txtDataReg, rawDataReg] = xlsread('Hdata_new.xlsx','final_data');
rand_DataReg = numDataReg(randperm(size(numDataReg,1)),:);

% [bode_std, bode_mean] = std(numDataReg);
% std_trainReg = bode_std(:,1:200);
% mean_trainReg = bode_mean(:,1:200);
% std_evalReg = bode_std(:,201:205);
% mean_evalReg = bode_mean(:,201:205);

trainReg_X = rand_DataReg(train_samplesReg,:);
testReg_X = rand_DataReg(test_samplesReg,:);

% trainReg_X_norm = normalize(trainReg_X);
% testReg_X_norm = normalize(testReg_X);

% trainReg_X = bodeDataReg(ID_REG(train_samplesReg),1:200);
% trainReg_y = bodeDataReg(ID_REG(train_samplesReg),201:205)';
% testReg_X = bodeDataReg(ID_REG(test_samplesReg),1:200);
% testReg_y = bodeDataReg(ID_REG(test_samplesReg),201:205);

% trainReg_X = bodeDataReg(ID_REG(train_samplesReg),1:205);
% % trainReg_y = bodeDataReg(ID_REG(train_samplesReg),201:205)';
% testReg_X = bodeDataReg(ID_REG(test_samplesReg),1:205);
% % testReg_y = bodeDataReg(ID_REG(test_samplesReg),201:205)';

% a = [1,2,3;4,5,6;7,8,9;10,11,12;13,14,15];
% a(randperm(size(a,1)),:);
%% Data to train Classifier-2 and 3
faulty_cases = 1000;
ID_CLF2 = randperm(faulty_cases);
train_samplesCLF2 = 1:round(0.8*faulty_cases);
test_samplesCLF2 = round(0.8*faulty_cases)+1:faulty_cases;        

[numDataCLF2, txtDataCLF2, rawDataCLF2] = xlsread('Fdata_new.xlsx','final_data');
bodeDataCLF2 = normalize(numDataCLF2);
[bode_std,bode_mean] = std(numDataCLF2);
std_trainCLF2 = bode_std(:,1:200);
mean_trainCLF2 = bode_mean(:,1:200);

% Classifier-2 for Fault-Location Identification
trainCLF2_X = bodeDataCLF2(ID_CLF2(train_samplesCLF2),1:200);
trainCLF2_y = txtDataCLF2(ID_CLF2(train_samplesCLF2),1);
testCLF2_X = bodeDataCLF2(ID_CLF2(test_samplesCLF2),1:200);
testCLF2_y = txtDataCLF2(ID_CLF2(test_samplesCLF2),1);

% Classifier-3 for Fault-Type Identification
trainCLF3_X = trainCLF2_X;
trainCLF3_y = txtDataCLF2(ID_CLF2(train_samplesCLF2),2);
testCLF3_X = testCLF2_X;
testCLF3_y = txtDataCLF2(ID_CLF2(test_samplesCLF2),2);

% Model Evaluation
classifier_health = trainedModelCLF1.predictFcn;
classifier_faultLoc = trainedModelCLF2.predictFcn;
classifier_faultType = trainedModelCLF3.predictFcn;
regressor = trainedModelReg.Network;

% Test Input Data
x1 = [-56.97350319	-55.21530541	-53.44051308	-51.65170297	-49.85108505	-48.04054442	-46.22168178	-44.39585121	-42.56419453	-40.72767201	-38.88708953	-37.04312205	-35.19633413	-33.34719731	-31.49610511	-29.64338567	-27.78931256	-25.93411386	-24.07797999	-22.22107032	-20.36351895	-18.50543984	-16.64693156	-14.78808187	-12.92897253	-11.06968471	-9.210305622	-7.350936938	-5.491706325	-3.632783385	-1.774402267	0.083105988	1.939266896	3.793395415	5.644499168	7.49113917	9.331230171	11.16175622	12.97836937	14.77483168	16.54225645	18.26811144	19.93497951	21.51915671	22.98933564	24.30589398	25.42163288	26.2849751	26.84623109	27.06622739	26.92471926	26.42499402	25.59233682	24.46709255	23.09552628	21.52182364	19.78294342	17.90629377	15.90930775	13.79989001	11.57695587	9.230551055	6.741178879	4.077927145	1.194726769	-1.976574651	-5.539164221	-9.656940081	-14.61078056	-20.94230968	-29.92438583	-46.06657695	-74.51583957	-38.75395293	-26.59013026	-19.06590726	-13.57762136	-9.230698172	-5.610015158	-2.488672066	0.271368081	2.760959906	5.043786862	7.166895821	9.166590738	11.07184805	12.90632571	14.68955021	16.43762768	18.16369544	19.87824988	21.58943085	23.30330326	25.02414856	26.75476257	28.49674758	30.25078552	32.01688125	33.79456936	35.58308213	74.9892829	76.12436245	77.15406788	78.0838856	78.91920934	79.66522085	80.32680132	80.9084676	81.41432762	81.84805043	82.21284675	82.51145701	82.74614409	82.91868876	83.03038611	83.08204165	83.07396587	83.00596643	82.87733704	82.68684226	82.43269747	82.11254296	81.72341134	81.26168691	80.72305574	80.10244444	79.39394568	78.59072754	77.68492349	76.66749879	75.52808846	74.25480112	72.83398226	71.24993062	69.48456209	67.51701914	65.32323114	62.87544625	60.14178352	57.08590333	53.66697566	49.84025221	45.55872462	40.77655512	35.45510293	29.57221379	23.1346063	16.1913167	8.843503532	1.244119179	-6.4172055	-13.94213684	-21.15494243	-27.92541686	-34.17704308	-39.88191921	-45.04854504	-49.70842421	-53.90494129	-57.68556166	-61.09702304	-64.18270956	-66.98140491	-69.5267869	-71.84717991	-73.96513586	-75.89626467	-77.64607191	-79.20115259	-80.50084419	-81.31431819	-80.21462217	74.05262973	89.15943261	89.35907178	88.70094902	87.84487049	86.94472472	86.05878452	85.21730153	84.44014803	83.74242765	83.13623939	82.63098981	82.23315344	81.94590927	81.76889137	81.69818361	81.72660378	81.84425284	82.03925391	82.29857925	82.60886256	82.9571125	83.33127309	83.72060885	84.11591934	84.50960687	84.89563067	85.2693829];
x2 = [-96.49208201	-96.47185481	-96.44754527	-96.4183426	-96.38328072	-96.34121114	-96.29077205	-96.23035383	-96.15806123	-96.07167277	-95.9685988	-95.84584009	-95.6999501	-95.52700492	-95.32258659	-95.08178631	-94.79923559	-94.4691731	-94.08555457	-93.64221043	-93.13305099	-92.55231297	-91.89483265	-91.15632354	-90.33363037	-89.42492967	-88.42985099	-87.34950201	-86.1863941	-84.94427872	-83.62791655	-82.24280798	-80.79491455	-79.29039683	-77.73538743	-76.13580925	-74.49724223	-72.82483588	-71.12326143	-69.39669588	-67.64882988	-65.88289218	-64.10168447	-62.30762179	-60.5027751	-58.68891329	-56.86754322	-55.03994691	-53.2072152	-51.37027809	-49.5299316	-47.68686171	-45.84166541	-43.99486952	-42.14694753	-40.29833488	-38.44944306	-36.6006729	-34.75242736	-32.9051241	-31.0592081	-29.21516456	-27.37353213	-25.53491657	-23.70000465	-21.86957801	-20.0445264	-18.22585924	-16.41471423	-14.61236085	-12.82019628	-11.03973043	-9.272556339	-7.520301952	-5.784559916	-4.066793142	-2.368216779	-0.689661214	0.968573963	2.606859324	4.226347807	5.829037252	7.417763325	8.996110834	10.56824405	12.13867119	13.7119708	15.29251485	16.88422269	18.49037253	20.11348499	21.75528101	23.41670551	25.09800205	26.798821	28.51834418	30.25541174	32.00864055	33.77652717	35.55753176	5.703371607	6.255212799	6.859510788	7.520955104	8.244560741	9.035660369	9.899884681	10.84312703	11.87148771	12.99119255	14.2084796	15.52944772	16.9598606	18.5049014	20.16887527	21.95486143	23.86432331	25.8966933	28.04896028	30.31529841	32.68678578	35.15126633	37.69340464	40.29496959	42.93535746	45.59233168	48.24292204	50.86439775	53.4352155	55.93584791	58.34941981	60.66211184	62.86332611	64.94563838	66.90458097	68.73830926	70.44720336	72.0334491	73.50063159	74.85336349	76.09696034	77.23716764	78.27993898	79.2312612	80.09702069	80.88290465	81.59433078	82.23639981	82.81386576	83.33111981	83.79218422	84.20071366	84.56000185	84.87299175	85.14228841	85.37017345	85.55862093	85.70931432	85.82366473	85.90283078	85.94774073	85.95911776	85.93750962	85.88332427	85.79687315	85.67842446	85.52826876	85.3467994	85.13461007	84.89261131	84.62216635	84.32524447	84.0045869	83.66387529	83.30788706	82.94261526	82.57532438	82.2145099	81.86973065	81.55129169	81.26977326	81.03542744	80.8574941	80.74351435	80.69873425	80.72568677	80.82401508	80.99056004	81.21969017	81.50381586	81.83400856	82.20064309	82.59399369	83.00473489	83.42432098	83.84523794	84.26113679	84.66686684	85.05843207	85.43289433];
x3 = [-124.1926587	-124.1724313	-124.1481215	-124.1189185	-124.0838563	-124.0417862	-123.9913466	-123.9309278	-123.8586344	-123.772245	-123.66917	-123.5464099	-123.4005183	-123.2275712	-123.0231506	-122.7823475	-122.4997934	-122.1697268	-121.7861034	-121.3427534	-120.8335868	-120.2528403	-119.5953496	-118.8568281	-118.03412	-117.1254013	-116.1303009	-115.0499258	-113.8867864	-112.6446331	-111.3282253	-109.9430618	-108.4951021	-106.9905046	-105.4353991	-103.8357052	-102.1969988	-100.5244246	-98.82264795	-97.09583886	-95.34767955	-93.58138859	-91.79975543	-90.00518039	-88.19971666	-86.38511179	-84.56284697	-82.73417327	-80.90014437	-79.06164552	-77.21941903	-75.37408623	-73.52616653	-71.67609361	-69.82422922	-67.97087487	-66.11628171	-64.2606588	-62.40418011	-60.54699033	-58.68920977	-56.83093845	-54.9722595	-53.11324198	-51.2539433	-49.39441111	-47.53468502	-45.67479793	-43.81477713	-41.95464533	-40.09442136	-38.23412085	-36.3737568	-34.51334	-32.65287939	-30.79238242	-28.93185525	-27.07130302	-25.21072997	-23.35013965	-21.48953498	-19.6289184	-17.76829193	-15.90765725	-14.04701575	-12.1863686	-10.32571675	-8.465061	-6.604402012	-4.743740334	-2.883076426	-1.022410664	0.838256637	2.698925214	4.559594852	6.42026537	8.280936619	10.14160847	12.00228083	13.86295361	5.710593137	6.263138419	6.868209147	7.530501541	8.255037943	9.047159085	9.912504506	10.85697727	11.88668833	13.00787521	14.2267888	15.54954204	16.98191408	18.52910506	20.19543874	21.9840148	23.89631907	25.93180859	28.08749925	30.35759483	32.733206	35.20221239	37.74931778	40.35633408	43.00270474	45.66624502	48.32404155	50.95342594	53.53292333	56.04308147	58.46710764	60.79127294	63.00507873	65.10120969	67.07531763	68.92568901	70.65284775	72.25913741	73.7483161	75.12518618	76.39527119	77.56454465	78.63921002	79.62552791	80.52968454	81.35769537	82.11533726	82.80810366	83.44117774	84.01941915	84.54736097	85.02921416	85.46887722	85.86994927	86.23574557	86.56931407	86.87345272	87.15072662	87.40348496	87.63387728	87.84386905	88.03525635	88.20967964	88.36863664	88.51349427	88.64549975	88.76579078	88.875405	88.97528858	89.06630422	89.14923839	89.22480803	89.29366663	89.35640981	89.4135804	89.46567313	89.51313886	89.55638845	89.59579631	89.63170361	89.66442126	89.69423256	89.72139565	89.74614575	89.76869721	89.78924531	89.80796803	89.82502751	89.8405715	89.85473463	89.86763955	89.87939805	89.89011197	89.8998741	89.90876899	89.91687369	89.9242584	89.93098706	89.93711798	89.94270424];
x4 = [0.11964511	0.119645862	0.119646768	0.119647859	0.119649173	0.119650755	0.119652662	0.119654958	0.119657724	0.119661055	0.119665068	0.119669901	0.119675723	0.119682735	0.119691182	0.119701355	0.119713609	0.119728369	0.119746148	0.119767562	0.119793356	0.119824424	0.119861846	0.119906921	0.119961213	0.120026608	0.120105376	0.120200251	0.120314527	0.120452171	0.120617962	0.120817654	0.121058178	0.121347883	0.121696822	0.122117104	0.122623312	0.123233007	0.123967337	0.124851769	0.125916967	0.127199851	0.128744871	0.130605536	0.132846254	0.13554454	0.138793669	0.142705855	0.147416067	0.153086589	0.159912486	0.168128123	0.178014933	0.189910668	0.20422036	0.221429293	0.242118272	0.266981526	0.296847559	0.332703278	0.375721622	0.427292868	0.489059568	0.562954784	0.651242893	0.756561614	0.881963133	1.030951174	1.207509708	1.41611762	1.661742456	1.949805388	2.286109402	2.676723719	3.12782027	3.645462881	4.235356603	4.902572638	5.651272009	6.484456534	7.403776742	8.409421819	9.500106795	10.67315877	11.92469018	13.24983603	14.64302616	16.09826304	17.60938049	19.17026567	20.77503494	22.41816138	24.09455724	25.79961754	27.52923291	29.27977953	31.04809347	32.83143521	34.62744925	36.43412208	0.034741969	0.038129268	0.041846823	0.045926835	0.050404642	0.05531903	0.060712563	0.066631958	0.073128485	0.080258413	0.088083497	0.096671514	0.106096846	0.116441131	0.127793961	0.140253667	0.153928164	0.168935886	0.185406817	0.203483607	0.223322816	0.245096261	0.268992508	0.295218502	0.324001355	0.355590313	0.390258904	0.428307311	0.470064955	0.51589334	0.566189175	0.621387785	0.681966859	0.748450558	0.821414009	0.901488231	0.989365526	1.085805375	1.191640888	1.307785845	1.435242385	1.575109382	1.728591567	1.897009435	2.08180999	2.284578364	2.507050331	2.751125755	3.018882936	3.312593843	3.634740141	3.988029881	4.375414643	4.800106799	5.265596458	5.775667442	6.33441143	6.946239108	7.615886778	8.348416444	9.149206804	10.02393197	10.97852395	12.01911418	13.15194861	14.3832702	15.71916244	17.16534773	18.7269358	20.40811996	22.2118237	24.13930666	26.18974832	28.3598384	30.64341418	33.03119412	35.51066113	38.06614429	40.67913223	43.32882508	45.99289796	48.64841473	51.2728039	53.84479729	56.34523896	58.75769495	61.06882811	63.26853655	65.34988321	67.30886262	69.14405772	70.85623803	72.44794183	73.9230743	75.28654258	76.54393893	77.70127588	78.76477232	79.74068603	80.63518687];

%% Z_test cases for ECCE paper
% 0.5	5.5	100.5	5.5	100.5
z_normal = [-7.201694583	-7.200367389	-7.198768986	-7.196844005	-7.194525794	-7.191734134	-7.188372488	-7.184324703	-7.179451061	-7.173583538	-7.166520137	-7.158018115	-7.147785904	-7.135473482	-7.120660948	-7.102844982	-7.081422872	-7.055673735	-7.024736588	-6.987584868	-6.94299711	-6.88952351	-6.825448312	-6.748748168	-6.657047039	-6.547568703	-6.417088734	-6.26188869	-6.077716468	-5.859757984	-5.602626661	-5.300378114	-4.946557808	-4.534288596	-4.05640266	-3.505617987	-2.874753329	-2.156968275	-1.346008261	-0.436430234	0.57621395	1.695250375	2.922807759	4.259760982	5.70561969	7.258231185	8.913083829	10.66187307	12.48981274	14.37095903	16.26071996	18.08529536	19.73033619	21.03729433	21.82368813	21.93883925	21.33279053	20.08199111	18.34611743	16.29805634	14.07818583	11.7831491	9.473786099	7.187929768	4.951870966	2.789343239	0.728564454	-1.192173988	-2.920735749	-4.390812953	-5.527655718	-6.261620657	-6.5470787	-6.378325673	-5.792892319	-4.859978751	-3.661352327	-2.274548495	-0.763404088	0.824563357	2.456716012	4.112292116	5.779271525	7.451693657	9.127555827	10.80724034	12.4923755	14.18504212	15.88725334	17.60064802	19.32634582	21.06491772	22.81643137	24.58053812	26.35657604	28.14367159	29.94082941	31.74700531	33.56116139	35.38230468	1.162773312	1.276075727	1.400403577	1.536824944	1.686509836	1.850739412	2.030915889	2.228573108	2.445387739	2.683191065	2.943981231	3.229935803	3.543424371	3.887020865	4.26351507	4.675922664	5.127492869	5.621712488	6.162304723	6.753220709	7.398621109	8.102844432	8.870357972	9.705686382	10.61331204	11.59754058	12.66232441	13.81103702	15.04619175	16.36910064	17.77947282	19.2749576	20.85064532	22.49854815	24.20709295	25.96066529	27.73924576	29.51817246	31.26804345	32.95474071	34.53951273	35.97900411	37.22507366	38.22420621	38.91630508	39.23266128	39.09295697	38.40134061	37.0420724	34.87633394	31.74415011	27.47965625	21.95326632	15.15335513	7.29434221	-1.121986729	-9.39520209	-16.85736683	-23.07601907	-27.89304697	-31.3382955	-33.52338438	-34.57034386	-34.57742506	-33.60819501	-31.69265138	-28.83505889	-25.02759384	-20.27101104	-14.60285685	-8.129012919	-1.045947689	6.364623993	13.77847453	20.8947503	27.49223566	33.45139738	38.74283916	43.39918928	47.4866012	51.08354844	54.26780036	57.10962911	59.66897957	61.99490727	64.12622643	66.09275831	67.91683233	69.61483083	71.19864403	72.6769496	74.05626995	75.3417928	76.53796659	77.64890011	78.67860466	79.63111883	80.51055228	81.32107879	82.0669013];

%% Healhty Cases
% Load1 increase by 20%
Load1_increase = [-6.912288607	-6.91095176	-6.909341729	-6.907402739	-6.905067652	-6.902255657	-6.89886951	-6.894792201	-6.88988298	-6.883972577	-6.87685749	-6.868293161	-6.857985823	-6.845582799	-6.830660976	-6.812713141	-6.791131858	-6.765190516	-6.734021162	-6.696588747	-6.651661452	-6.597776811	-6.533203551	-6.455899258	-6.363464398	-6.253093716	-6.121526795	-5.96500045	-5.779206794	-5.559262018	-5.299692201	-4.994443377	-4.636923384	-4.220082164	-3.736534689	-3.178726224	-2.539133293	-1.810486131	-0.985991194	-0.059527656	0.97420766	2.119624483	3.380232725	4.758678044	6.256750824	7.875239001	9.613398497	11.46765299	13.42886106	15.47706113	17.57209452	19.63849647	21.54561047	23.09344847	24.03266041	24.14905333	23.380794	21.85730189	19.81437876	17.4801702	15.01917871	12.53142579	10.0720597	7.670946082	5.346990086	3.117959453	1.007548507	-0.949272043	-2.702777619	-4.188454284	-5.333002032	-6.068106583	-6.349453799	-6.172590247	-5.57609424	-4.629924551	-3.416362542	-2.013341114	-0.485101304	1.12035996	2.769840277	4.441959815	6.124081588	7.809691695	9.496354848	11.18418353	12.87471918	14.57013471	16.27268852	17.98437679	19.70674037	21.4407885	23.18700521	24.94540868	26.71563875	28.49705375	30.28882349	32.09001038	33.89963525	35.71672701	1.192308868	1.30849134	1.435980172	1.575870873	1.729363565	1.897772478	2.082536142	2.285228281	2.507569374	2.751438836	3.018887703	3.31215167	3.633664242	3.986069641	4.372234995	4.795261117	5.258490999	5.765514786	6.320169656	6.926532557	7.588903154	8.311773696	9.099781702	9.957640526	10.89004198	11.90152439	12.99629898	14.17802733	15.44954351	16.81251658	18.26705267	19.8112416	21.4406609	23.14785899	24.921849	26.74765191	28.6059291	30.47273697	32.31941546	34.11258845	35.81420696	37.38151238	38.76674108	39.91634062	40.76942323	41.25514738	41.28870734	40.76567987	39.55480366	37.49031429	34.36778552	29.95393037	24.03227449	16.51519701	7.622628778	-1.987765268	-11.35072013	-19.5862272	-26.21040349	-31.13574755	-34.49602767	-36.48870393	-37.29242029	-37.03853922	-35.80850344	-33.64127828	-30.54523357	-26.5142074	-21.54959139	-15.68934496	-9.039885752	-1.798280183	5.753454225	13.29143034	20.5157762	27.20651786	33.24517612	38.6030062	43.31294846	47.44134577	51.066977	54.26821831	57.11635352	59.67275968	61.98828091	64.10374937	66.05106995	67.85455121	69.53230258	71.0975858	72.56004542	73.92676971	75.2031566	76.39358044	77.50187298	78.5316436	79.48647058	80.36999568	81.18595201	81.93814989];
% Load decrease by 20%
Load1_decrease = [-7.695889719	-7.694581625	-7.693006231	-7.691108969	-7.688824154	-7.686072728	-7.682759558	-7.678770183	-7.673966925	-7.668184223	-7.661223051	-7.652844254	-7.642760598	-7.630627299	-7.616030791	-7.598475423	-7.577367771	-7.55199822	-7.521519465	-7.484921583	-7.441003367	-7.388339742	-7.325245183	-7.249733396	-7.159473857	-7.051746411	-6.92339586	-6.770789477	-6.589781541	-6.37569029	-6.123294015	-5.826854017	-5.480172502	-5.076692773	-4.609646676	-4.072250033	-3.457940747	-2.760647263	-1.975068615	-1.096943819	-0.123290274	0.947399687	2.114996768	3.37757305	4.731171521	6.16939469	7.682648996	9.256824602	10.87114203	12.49491065	14.08315737	15.57177366	16.87434787	17.88508966	18.49332991	18.61075655	18.20112983	17.29356716	15.96927385	14.33196562	12.48094602	10.49711884	8.440837862	6.356227268	4.277712678	2.236723961	0.267929518	-1.585281638	-3.266830139	-4.707286964	-5.829221477	-6.560420695	-6.852660095	-6.697741697	-6.131066821	-5.220216888	-4.045763847	-2.684252247	-1.198546011	0.364866083	1.974400073	3.610281815	5.261304765	6.922057043	8.590766786	10.26772307	11.95417508	13.65160957	15.36131792	17.08417639	18.82057449	20.57043797	22.33330412	24.1084186	25.8948334	27.6914939	29.49730945	31.31120634	33.13216439	34.95923984	1.113654218	1.222167051	1.34123817	1.471890056	1.615242651	1.772522146	1.945070398	2.134354963	2.341979712	2.569695959	2.819413994	3.09321484	3.393361973	3.72231266	4.082728373	4.47748362	4.909672232	5.382609876	5.899831176	6.465079326	7.082285533	7.755534916	8.489014723	9.286939855	10.15344984	11.0924706	12.1075339	13.2015473	14.37650845	15.63315952	16.97058173	18.38573551	19.87296021	21.4234566	23.02478557	24.66042383	26.30942037	27.94619037	29.54046575	31.05739125	32.4577163	33.69799194	34.73064954	35.50382315	35.96079279	36.03898412	35.66858615	34.77109031	33.25850424	31.03478429	28.00226623	24.07731164	19.21967206	13.4758003	7.023454157	0.187209182	-6.606357502	-12.92770737	-18.44307724	-22.95851433	-26.40332901	-28.78431969	-30.14121532	-30.51617387	-29.9375713	-28.41447917	-25.93912881	-22.49678453	-18.08392137	-12.73490516	-6.552809697	0.268302526	7.448156273	14.66246889	21.60893885	28.06424471	33.90687028	39.10588017	43.69264438	47.7319589	51.30049553	54.4735947	57.31847857	59.89158778	62.23829114	64.39384292	66.38491357	68.23129739	69.94756298	71.54451298	73.03038742	74.41179343	75.69437791	76.88327989	77.98340809	78.99958975	79.93663143	80.79932469	81.59242118	82.32059433];

% Load2 increase by 20%
Load2_increase = [-6.947410036	-6.946074153	-6.944465282	-6.942527691	-6.940194288	-6.937384323	-6.934000622	-6.929926261	-6.925020593	-6.919114471	-6.912004547	-6.903446441	-6.893146609	-6.88075264	-6.865841741	-6.847907092	-6.826341732	-6.800419626	-6.769273524	-6.731869235	-6.686975988	-6.633132605	-6.568609392	-6.491365885	-6.399004957	-6.288724346	-6.157267357	-6.000875459	-5.815246592	-5.595504273	-5.336183808	-5.031242874	-4.674104017	-4.257735767	-3.774776583	-3.217701403	-2.579024227	-1.851522625	-1.028462931	-0.10380027	0.927671756	2.070238747	3.327250122	4.70114219	6.193429956	7.804536931	9.533236477	11.37531965	13.32084118	15.34889407	17.41841342	19.45360549	21.32524057	22.83825629	23.75241437	23.86317007	23.11144867	21.61989029	19.61397201	17.31443678	14.88266784	12.41829997	9.977226821	7.59031601	5.277384509	3.056928507	0.953189646	-0.998465689	-2.748036199	-4.230819448	-5.373385443	-6.107320173	-6.388219799	-6.211547997	-5.615820495	-4.670969755	-3.459290074	-2.058753352	-0.533643298	1.068020605	2.713053968	4.380149866	6.056804865	7.736694382	9.417612237	11.09991474	12.7853725	14.47634541	16.17521702	17.88403837	19.60433826	21.33705947	23.08258282	24.84080488	26.6112414	28.39313581	30.1855591	31.98749408	33.79790105	35.61576561	1.188636635	1.304461019	1.431556832	1.571016175	1.724035423	1.891924695	2.076118004	2.278184113	2.499838054	2.742953253	3.009574167	3.301929258	3.622444078	3.973754102	4.358716827	4.780422469	5.242202339	5.747633705	6.300539539	6.904981098	7.565240698	8.285791387	9.071249402	9.926304477	10.85562217	11.8637116	12.9547514	14.13236681	15.3993513	16.75732855	18.20635394	19.74446068	21.36716311	23.06693941	24.83272489	26.64945469	28.49769618	30.35340343	32.18780624	33.96741149	35.65404869	37.20483777	38.57190267	39.7016048	40.53302891	40.99542508	41.00430937	40.45601233	39.22081673	37.13589993	34.00210486	29.59483094	23.70994859	16.27250886	7.505448005	-1.952127168	-11.17136942	-19.30278346	-25.87030125	-30.77712781	-34.14342653	-36.15569772	-36.98553195	-36.76025498	-35.55917915	-33.42024056	-30.35138385	-26.3463353	-21.40651699	-15.56995711	-8.943120325	-1.723080824	5.808149971	13.32665918	20.53249603	27.2055858	33.22739219	38.5692168	43.26417884	47.37892728	50.99264132	54.18413691	57.02510777	59.57723717	61.89150718	64.0086792	65.96037279	67.77042792	69.45636308	71.03080273	72.50278178	73.87886466	75.1640459	76.36242766	77.47769209	78.51340082	79.47316017	80.36069005	81.17982968	81.93450645];
% Load2 decrease by 20%
Load2_decrease = [-7.620452485	-7.619141583	-7.617562806	-7.615661469	-7.613371744	-7.610614403	-7.607294106	-7.603296143	-7.598482538	-7.592687365	-7.585711163	-7.577314249	-7.567208751	-7.555049115	-7.540420845	-7.522827159	-7.501673269	-7.476247901	-7.44570174	-7.40902241	-7.365005728	-7.312222975	-7.248984176	-7.173297582	-7.082825966	-6.974840912	-6.846177022	-6.69318894	-6.511715265	-6.297054732	-6.043961337	-5.746666074	-5.398933336	-4.994159261	-4.52551693	-3.986149059	-3.369402802	-2.669094181	-1.879783224	-0.997037322	-0.017662159	1.06011096	2.236474289	3.509895008	4.876898524	6.331668259	7.865290884	9.464409954	11.10898709	12.76885927	14.39896897	15.93384481	17.2835729	18.33614232	18.97266314	19.09744084	18.6715603	17.72789932	16.35568073	14.66691997	12.76685915	10.73950893	8.646230784	6.530974188	4.427476607	2.36634993	0.381500186	-1.48431757	-3.175515662	-4.623033265	-5.749724051	-6.483623958	-6.776757415	-6.621175102	-6.052493554	-5.138444481	-3.959687564	-2.592828955	-1.100816305	0.46971665	2.086960125	3.730835664	5.389776581	7.057992968	8.73336222	10.41589252	12.10665276	13.80706321	15.51845703	17.24184009	18.97779026	20.72644966	22.48757311	24.26060521	26.04476639	27.83913505	29.64271857	31.45450997	33.27352984	35.09885497	1.121174622	1.230420762	1.35029671	1.481831928	1.626154022	1.784497599	1.958213756	2.148780195	2.35781193	2.587072518	2.838485696	3.11414726	3.416336931	3.747529824	4.110407047	4.507864706	4.943020403	5.419215979	5.940014894	6.509192133	7.130713971	7.808704241	8.547392959	9.35104231	10.22384413	11.16978223	12.19245246	13.29483331	14.47900083	15.74578376	17.09435852	18.52178986	20.0225306	21.58790379	23.20560046	24.85923333	26.52799009	28.18642229	29.80438838	31.34713867	32.77549042	34.04599972	35.11100163	35.91837299	36.41088343	36.52505271	36.1895524	35.32342855	33.83488182	31.62218386	28.57969114	24.61366874	19.67336982	13.79864232	7.170973733	0.133498124	-6.857465866	-13.34362498	-18.97499809	-23.55636787	-27.02540592	-29.40030067	-30.73112332	-31.06788681	-30.44435916	-28.87307756	-26.34839673	-22.85684244	-18.39564974	-12.99970279	-6.772519155	0.091406691	7.311420482	14.56299954	21.54376771	28.03040877	33.90135126	39.12544525	43.73367736	47.79035995	51.37169403	54.55268629	57.40046953	59.97170639	62.31231053	64.45835653	66.43751587	68.27064472	69.97331613	71.55718588	73.0311391	74.4022028	75.67623375	76.85840711	77.95353966	78.96628404	79.90122866	80.76293359	81.55592657	82.2846774];

% PV power increase by 20%
PV_power_increase = [-7.139664133	-7.136531676	-7.132759874	-7.128218545	-7.122751132	-7.116169434	-7.108247289	-7.098713054	-7.087240643	-7.073438887	-7.056838936	-7.036879395	-7.012888866	-6.984065554	-6.949453608	-6.907915901	-6.858103034	-6.798418523	-6.726980355	-6.641579473	-6.5396363	-6.418157126	-6.273693107	-6.102305799	-5.899544411	-5.660441282	-5.379533175	-5.050916443	-4.668343591	-4.225366606	-3.715528372	-3.132597472	-2.470834245	-1.725268523	-0.891963921	0.031757741	1.047153637	2.153969143	3.350412389	4.633166607	5.997390413	7.436633579	8.942572757	10.50444696	12.10804748	13.73410209	15.35592214	16.93633397	18.42433709	19.75279087	20.83967732	21.59627243	21.94386692	21.83499015	21.26861298	20.28952974	18.97234335	17.40026749	15.64899352	13.77921946	11.83600755	9.85170389	7.850043868	5.850324424	3.871365324	1.935356028	0.071705318	-1.679287338	-3.263784777	-4.614618791	-5.656930039	-6.320943376	-6.559700972	-6.364182262	-5.76693107	-4.831746854	-3.635854389	-2.253692099	-0.747354538	0.836427254	2.465248468	4.11831245	5.783462711	7.454584147	9.129536431	10.80859168	12.49329507	14.18566701	15.88767778	17.60093636	19.32654184	21.06505109	22.81652223	24.58060009	26.35661835	28.14370051	29.9408492	31.74701886	33.56117069	35.38231106	1.779078466	1.952283486	2.142294487	2.350723937	2.579333164	2.83004421	3.104951994	3.406336561	3.736675093	4.098653192	4.495174824	4.929370045	5.404599372	5.924453272	6.492744837	7.113493123	7.790894016	8.529274724	9.333027204	10.20651496	11.15394695	12.17921178	13.28566537	14.47586615	15.75125373	17.11177081	18.55543395	20.07786664	21.67181824	23.32670277	25.02820092	26.75797362	28.49353223	30.20829702	31.87184988	33.45035255	34.90706353	36.20285369	37.29660062	38.14534217	38.70409101	38.92525686	38.75769196	38.14548306	37.02678724	35.33330467	32.99146795	29.92713937	26.07638007	21.40496697	15.93710768	9.787159109	3.178025606	-3.574593424	-10.11860632	-16.1397158	-21.41524436	-25.82665148	-29.33888315	-31.96755143	-33.74961557	-34.72319694	-34.9159198	-34.33930701	-32.98719645	-30.83731702	-27.85642198	-24.01045585	-19.28165815	-13.69317587	-7.337147132	-0.394515962	6.870314091	14.14932712	21.15288143	27.66402352	33.5616279	38.81157959	43.44112682	47.51176092	51.09844862	54.27653644	57.11471158	59.67191936	61.99660101	64.12720026	66.09331819	67.9171549	69.61501752	71.19875285	72.67701364	74.0563081	75.34181587	76.53798078	77.648909	78.67861034	79.63112253	80.51055474	81.32108045	82.06690244];
% PV power decrease by 20%
PV_power_decrease = [-7.235132985	-7.234469924	-7.233671311	-7.232709447	-7.231550977	-7.230155739	-7.228475378	-7.226451677	-7.224014559	-7.221079674	-7.217545513	-7.213289934	-7.208166002	-7.201997005	-7.194570478	-7.185631071	-7.174872027	-7.161925035	-7.14634816	-7.127611546	-7.105080513	-7.077995678	-7.04544968	-7.006360098	-6.959438179	-6.903153073	-6.835691395	-6.754912196	-6.658297767	-6.542901216	-6.405292486	-6.241505362	-6.046989136	-5.816569795	-5.544426791	-5.224092346	-4.848480434	-4.409951706	-3.900418013	-3.311485786	-2.634631289	-1.861393631	-0.983565274	0.006642759	1.116478987	2.352574508	3.720879034	5.226518042	6.873374814	8.663016166	10.592247	12.64799287	14.79730417	16.96942893	19.02838518	20.74529337	21.80843174	21.9290623	21.01645399	19.2437585	16.91923634	14.32295726	11.64205492	8.982603303	6.401472753	3.93290156	1.606325735	-0.542172842	-2.463075574	-4.091729936	-5.353938406	-6.180480797	-6.527638672	-6.39422361	-5.824470768	-4.894769035	-3.692865174	-2.300322432	-0.783216148	0.809938033	2.446211512	4.104889186	5.774123114	7.448146093	9.125126746	10.805584	12.49124894	14.18427689	15.88673375	17.60029513	19.32610599	21.06475456	22.81632024	24.58046234	26.3565243	28.14363622	29.9408052	31.74698873	33.56115003	35.38229689	0.825589878	0.906061627	0.994372113	1.091283299	1.197630699	1.314330309	1.442386139	1.582898382	1.737072241	1.906227444	2.091808455	2.295395379	2.518715521	2.763655554	3.032274172	3.326815069	3.649719996	4.003641513	4.391454967	4.816268962	5.281433416	5.790543933	6.347440871	6.956200952	7.621118721	8.346674393	9.137483865	9.998225721	10.93353915	11.9478858	13.04536798	14.2294954	15.50289324	16.86694613	18.32137589	19.86375608	21.48897325	23.18865304	24.95057676	26.7581189	28.58973372	30.4185055	32.21174839	33.9305946	35.52944522	36.95507598	38.14509666	39.02535851	39.50580089	39.4741653	38.78712957	37.25918578	34.65226293	30.67658016	25.02989003	17.52476204	8.33509831	-1.772179989	-11.57177309	-19.95046565	-26.35476141	-30.74915849	-33.34475239	-34.3932885	-34.09861133	-32.59737648	-29.96862016	-26.25487957	-21.49069912	-15.7379777	-9.123742985	-1.866741408	5.727260289	13.31182277	20.57086844	27.27742928	33.31404409	38.65746194	43.34724963	47.45551572	51.06517557	54.25704578	57.10338063	59.66536921	61.99282901	64.12503237	66.09207221	67.91643721	69.61460224	71.19851084	72.67687124	74.05622327	75.34176457	76.53794924	77.64888924	78.67859772	79.63111431	80.51054928	81.32107676	82.0668999];
%% Fault Cases
% % 0.7	1	1	1	1	S2	SC
% z_S2_SC = [-96.64439913	-96.62417652	-96.59987252	-96.5706765	-96.53562265	-96.49356273	-96.44313527	-96.38273107	-96.31045536	-96.22408724	-96.12103776	-95.99830856	-95.8524541	-95.67955174	-95.47518496	-95.23444679	-94.95197088	-94.62199848	-94.23848849	-93.79527506	-93.28627307	-92.70572468	-92.04847277	-91.31023876	-90.48787693	-89.57957531	-88.58497728	-87.50520718	-86.34279645	-85.1015207	-83.78616969	-82.40227881	-80.9558517	-79.45309963	-77.90021615	-76.3031975	-74.66771175	-72.99901438	-71.30190387	-69.58071004	-67.8393069	-66.08114302	-64.30928338	-62.52645806	-60.73511436	-58.93747008	-57.13556645	-55.33132	-53.52657283	-51.72314122	-49.92286235	-48.1276388	-46.33948031	-44.5605416	-42.79315433	-41.03985064	-39.30337434	-37.58667489	-35.89287836	-34.22522869	-32.58699314	-30.98132692	-29.41109558	-27.87865902	-26.38562853	-24.93261709	-23.51901144	-22.14280023	-20.80049298	-19.48715748	-18.19658908	-16.92160522	-15.65443708	-14.38717201	-13.11219126	-11.82254894	-10.51225113	-9.17641478	-7.811309232	-6.414302861	-4.983748661	-3.518843991	-2.019492379	-0.48618315	1.080107443	2.677998461	4.305778043	5.961475654	7.642936046	9.3478942	11.07404781	12.81912299	14.58092952	16.35740338	18.14663622	19.94689236	21.75661549	23.57442692	25.39911791	27.22963799	5.660395062	6.208046115	6.807745439	7.464142733	8.182209283	8.967229785	9.824782285	10.76070235	11.78102688	12.89191209	14.09951969	15.40986469	16.82861883	18.36086432	20.01079554	21.78137018	23.67391826	25.68772583	27.81962117	30.06360221	32.41055376	34.84810763	37.36069573	39.92983177	42.53463208	45.15255317	47.76028826	50.33473765	52.85395367	55.29796596	57.64941414	59.89394764	62.02038733	64.02067332	65.88964336	67.62469447	69.22537979	70.69298443	72.03011415	73.24031878	74.32776328	75.29695124	76.15250065	76.89896846	77.54071887	78.08183007	78.52603422	78.87668678	79.13676204	79.30887321	79.39531676	79.39814173	79.31924596	79.16050193	78.92391534	78.61181896	78.22710335	77.77348275	77.25579028	76.68028968	76.05498187	75.38987452	74.69717208	73.9913359	73.28896166	72.608429	71.96929823	71.39146235	70.89410495	70.49455947	70.20719969	70.04250595	70.00643754	70.10019928	70.32042734	70.65974891	71.10761132	71.65124098	72.27659058	72.96916124	73.71463505	74.49930641	75.31034324	76.13593098	76.96535319	77.78904695	78.59865029	79.38704081	80.1483549	80.87797577	81.57248377	82.22956964	82.84791739	83.42706761	83.9672724	84.46935218	84.93456218	85.36447341	85.76087073	86.12566853];
% % 0.7	1	1	1	1	S2	OC
% z_S2_OC = [-124.1926587	-124.1724313	-124.1481215	-124.1189185	-124.0838563	-124.0417862	-123.9913466	-123.9309278	-123.8586344	-123.772245	-123.66917	-123.5464099	-123.4005183	-123.2275712	-123.0231506	-122.7823475	-122.4997934	-122.1697268	-121.7861034	-121.3427534	-120.8335868	-120.2528403	-119.5953496	-118.8568281	-118.03412	-117.1254013	-116.1303009	-115.0499258	-113.8867864	-112.6446331	-111.3282253	-109.9430618	-108.4951021	-106.9905046	-105.4353991	-103.8357052	-102.1969988	-100.5244246	-98.82264795	-97.09583886	-95.34767955	-93.58138859	-91.79975543	-90.00518039	-88.19971666	-86.38511179	-84.56284697	-82.73417327	-80.90014437	-79.06164552	-77.21941903	-75.37408623	-73.52616653	-71.67609361	-69.82422922	-67.97087487	-66.11628171	-64.2606588	-62.40418011	-60.54699033	-58.68920977	-56.83093845	-54.9722595	-53.11324198	-51.2539433	-49.39441111	-47.53468502	-45.67479793	-43.81477713	-41.95464533	-40.09442136	-38.23412085	-36.3737568	-34.51334	-32.65287939	-30.79238242	-28.93185525	-27.07130302	-25.21072997	-23.35013965	-21.48953498	-19.6289184	-17.76829193	-15.90765725	-14.04701575	-12.1863686	-10.32571675	-8.465061	-6.604402012	-4.743740334	-2.883076426	-1.022410664	0.838256637	2.698925214	4.559594852	6.42026537	8.280936619	10.14160847	12.00228083	13.86295361	5.710593137	6.263138419	6.868209147	7.530501541	8.255037943	9.047159085	9.912504506	10.85697727	11.88668833	13.00787521	14.2267888	15.54954204	16.98191408	18.52910506	20.19543874	21.9840148	23.89631907	25.93180859	28.08749925	30.35759483	32.733206	35.20221239	37.74931778	40.35633408	43.00270474	45.66624502	48.32404155	50.95342594	53.53292333	56.04308147	58.46710764	60.79127294	63.00507873	65.10120969	67.07531763	68.92568901	70.65284775	72.25913741	73.7483161	75.12518618	76.39527119	77.56454465	78.63921002	79.62552791	80.52968454	81.35769537	82.11533726	82.80810366	83.44117774	84.01941915	84.54736097	85.02921416	85.46887722	85.86994927	86.23574557	86.56931407	86.87345272	87.15072662	87.40348496	87.63387728	87.84386905	88.03525635	88.20967964	88.36863664	88.51349427	88.64549975	88.76579078	88.875405	88.97528858	89.06630422	89.14923839	89.22480803	89.29366663	89.35640981	89.4135804	89.46567313	89.51313886	89.55638845	89.59579631	89.63170361	89.66442126	89.69423256	89.72139565	89.74614575	89.76869721	89.78924531	89.80796803	89.82502751	89.8405715	89.85473463	89.86763955	89.87939805	89.89011197	89.8998741	89.90876899	89.91687369	89.9242584	89.93098706	89.93711798	89.94270424];
% 
% % 0.7	1	1	1	1	L1	SC
% z_L1_SC = [-102.6734743	-102.6070586	-102.5427462	-102.4791213	-102.4146037	-102.3474483	-102.2757314	-102.1973272	-102.1098751	-102.0107404	-101.8969708	-101.7652521	-101.6118662	-101.4326564	-101.2230067	-100.9778401	-100.6916457	-100.3585422	-99.97238429	-99.52691731	-99.01598003	-98.43374891	-97.77500944	-97.03543209	-96.21182502	-95.30233336	-94.30655941	-93.22558686	-92.06190554	-90.81924706	-89.50235327	-88.11670609	-86.66824832	-85.1631209	-83.60743513	-82.00709027	-80.36763941	-78.69420098	-76.99140987	-75.26340005	-73.51381092	-71.74580976	-69.96212423	-68.16507993	-66.35663927	-64.53843907	-62.71182499	-60.87788152	-59.03745669	-57.19118058	-55.33947713	-53.48256802	-51.62046726	-49.75296433	-47.87959243	-45.99957663	-44.11175376	-42.21445137	-40.30530537	-38.38098326	-36.4367571	-34.46582958	-32.45823705	-30.39899355	-28.26479241	-26.01777015	-23.59274716	-20.86830569	-17.59164622	-13.14362826	-5.648836139	0.717755975	-43.03496371	-39.17844471	-27.51597479	-22.16138547	-18.56761285	-15.71809903	-13.24997754	-11.00005009	-8.883742458	-6.852875233	-4.878155357	-2.940956268	-1.029069671	0.865665903	2.748773545	4.624016256	6.493965168	8.36037701	10.2244494	12.08699546	13.94856407	15.80952291	17.67011583	19.53050246	21.39078554	23.25102959	25.1112738	26.97154066	7.939808293	8.338751622	8.793631181	9.310722881	9.896186912	10.55612117	11.29660614	12.12373153	13.04359672	14.06227788	15.18575535	16.41979508	17.76977894	19.24047941	20.83577745	22.55832584	24.40916723	26.38732456	28.48939202	30.70916592	33.03736441	35.46148937	37.96588083	40.53199971	43.13894962	45.76421526	48.38456002	50.9769974	53.51973727	55.99301263	58.37971404	60.66579141	62.84041783	64.89593987	66.82765861	68.63349415	70.31358534	71.86986868	73.30566971	74.625329	75.83387517	76.93674934	77.93958057	78.84800797	79.66754389	80.40347145	81.06077023	81.64406416	82.15758637	82.60515649	82.99016655	83.315572	83.58388456	83.79716361	83.95700209	84.06450135	84.1202271	84.1241333	84.07543265	83.97237657	83.81187899	83.5888631	83.29509902	82.91706296	82.43180158	81.79840613	80.93880083	79.68875324	77.64859563	73.58430588	61.53557395	-8.902712351	-48.70842843	85.19507114	87.98996887	87.72762351	87.35584485	87.08856092	86.93053651	86.86208869	86.86337588	86.91763477	87.01111553	87.13261138	87.27304541	87.42514481	87.58317209	87.74269025	87.90035119	88.0537047	88.20102818	88.34117804	88.47346288	88.59753739	88.7133156	88.82090097	88.92053119	89.01253519	89.09730015	89.17524666];
% % 0.7	1	1	1	1	L1	OC
% z_L1_OC = [-124.1926587	-124.1724313	-124.1481215	-124.1189185	-124.0838563	-124.0417862	-123.9913466	-123.9309278	-123.8586344	-123.772245	-123.66917	-123.5464099	-123.4005183	-123.2275712	-123.0231506	-122.7823475	-122.4997934	-122.1697268	-121.7861034	-121.3427534	-120.8335868	-120.2528403	-119.5953496	-118.8568281	-118.03412	-117.1254013	-116.1303009	-115.0499258	-113.8867864	-112.6446331	-111.3282253	-109.9430618	-108.4951021	-106.9905046	-105.4353991	-103.8357052	-102.1969988	-100.5244246	-98.82264795	-97.09583886	-95.34767955	-93.58138859	-91.79975543	-90.00518039	-88.19971666	-86.38511179	-84.56284697	-82.73417327	-80.90014437	-79.06164552	-77.21941903	-75.37408623	-73.52616653	-71.67609361	-69.82422922	-67.97087487	-66.11628171	-64.2606588	-62.40418011	-60.54699033	-58.68920977	-56.83093845	-54.9722595	-53.11324198	-51.2539433	-49.39441111	-47.53468502	-45.67479793	-43.81477713	-41.95464533	-40.09442136	-38.23412085	-36.3737568	-34.51334	-32.65287939	-30.79238242	-28.93185525	-27.07130302	-25.21072997	-23.35013965	-21.48953498	-19.6289184	-17.76829193	-15.90765725	-14.04701575	-12.1863686	-10.32571675	-8.465061	-6.604402012	-4.743740334	-2.883076426	-1.022410664	0.838256637	2.698925214	4.559594852	6.42026537	8.280936619	10.14160847	12.00228083	13.86295361	5.710593137	6.263138419	6.868209147	7.530501541	8.255037943	9.047159085	9.912504506	10.85697727	11.88668833	13.00787521	14.2267888	15.54954204	16.98191408	18.52910506	20.19543874	21.9840148	23.89631907	25.93180859	28.08749925	30.35759483	32.733206	35.20221239	37.74931778	40.35633408	43.00270474	45.66624502	48.32404155	50.95342594	53.53292333	56.04308147	58.46710764	60.79127294	63.00507873	65.10120969	67.07531763	68.92568901	70.65284775	72.25913741	73.7483161	75.12518618	76.39527119	77.56454465	78.63921002	79.62552791	80.52968454	81.35769537	82.11533726	82.80810366	83.44117774	84.01941915	84.54736097	85.02921416	85.46887722	85.86994927	86.23574557	86.56931407	86.87345272	87.15072662	87.40348496	87.63387728	87.84386905	88.03525635	88.20967964	88.36863664	88.51349427	88.64549975	88.76579078	88.875405	88.97528858	89.06630422	89.14923839	89.22480803	89.29366663	89.35640981	89.4135804	89.46567313	89.51313886	89.55638845	89.59579631	89.63170361	89.66442126	89.69423256	89.72139565	89.74614575	89.76869721	89.78924531	89.80796803	89.82502751	89.8405715	89.85473463	89.86763955	89.87939805	89.89011197	89.8998741	89.90876899	89.91687369	89.9242584	89.93098706	89.93711798	89.94270424];
% 
% % 0.7	1	1	1	1	L2	SC
% z_L2_SC = [-93.12573812	-92.99165812	-92.86803128	-92.75282913	-92.6437758	-92.5383969	-92.43404413	-92.32789808	-92.21695268	-92.09798547	-91.96751813	-91.82177186	-91.65662277	-91.46756307	-91.24967459	-90.9976223	-90.70567584	-90.3677677	-89.97759516	-89.52877071	-89.01502109	-88.43042826	-87.76969785	-87.02843275	-86.20338351	-85.29264591	-84.29577949	-83.21383035	-82.04925461	-80.80575299	-79.48803814	-78.10156353	-76.65224323	-75.14618818	-73.58947741	-71.98797444	-70.34719194	-68.6722018	-66.96758454	-65.23741005	-63.48524157	-61.71415537	-59.92676988	-58.12527914	-56.31148669	-54.48683698	-52.65244219	-50.80910271	-48.95731992	-47.09729967	-45.22894483	-43.3518344	-41.46518582	-39.56779539	-37.6579493	-35.73329376	-33.79064663	-31.82572316	-29.83273205	-27.80377091	-25.72790275	-23.58971167	-21.36698418	-19.0268874	-16.51953903	-13.76724545	-10.648503	-6.992324676	-2.75342782	0.27868128	-6.044084426	-24.18518811	-61.51818397	-38.89664996	-27.1414576	-21.0323899	-16.92184351	-13.77156147	-11.15859697	-8.873695671	-6.799187861	-4.862582624	-3.016222781	-1.227400923	0.526864747	2.262822961	3.991852806	5.721724244	7.457513303	9.202299412	10.95770943	12.72434335	14.50210374	16.29044554	18.08856048	19.895509	21.71031117	23.5320063	25.3596897	27.19253293	10.86718234	11.08215989	11.35293067	11.68857764	12.09745977	12.58731098	13.1653518	13.83839171	14.61290582	15.49507296	16.49076599	17.60548664	18.84423986	20.21134382	21.71017525	23.34285388	25.10987603	27.00971628	29.03842612	31.18926993	33.4524475	35.81495737	38.26065123	40.77051588	43.32319355	45.89571825	48.46441093	51.00584818	53.49780556	55.92008109	58.25512634	60.48844464	62.60875105	64.60791866	66.48075525	68.22466314	69.83923379	71.3258211	72.68712655	73.92681819	75.04919554	76.05890495	76.96070407	77.75927132	78.4590536	79.06414524	79.57819067	80.00430359	80.34499551	80.60210643	80.77673016	80.86912537	80.8786014	80.80336403	80.64029979	80.3846665	80.02963938	79.56563014	78.97923962	78.25160052	77.35566635	76.25160016	74.87855825	73.13920895	70.86850699	67.76520195	63.22532329	55.88628	42.26973178	14.21857333	-26.76042233	-50.51387874	-17.41520046	85.58695377	87.55180563	86.40929892	85.10156421	83.98249979	83.09793739	82.4376983	81.98067199	81.70399536	81.58475364	81.60025647	81.72825653	81.94732868	82.23734134	82.57990707	82.95872705	83.35978747	83.77140395	84.18413601	84.59060625	84.98526095	85.36410484	85.72443518	86.06459215	86.38373594	86.68165457	86.95860353];
% % 0.7	1	1	1	1	L2	OC
% z_L2_OC = [-124.1926587	-124.1724313	-124.1481215	-124.1189185	-124.0838563	-124.0417862	-123.9913466	-123.9309278	-123.8586344	-123.772245	-123.66917	-123.5464099	-123.4005183	-123.2275712	-123.0231506	-122.7823475	-122.4997934	-122.1697268	-121.7861034	-121.3427534	-120.8335868	-120.2528403	-119.5953496	-118.8568281	-118.03412	-117.1254013	-116.1303009	-115.0499258	-113.8867864	-112.6446331	-111.3282253	-109.9430618	-108.4951021	-106.9905046	-105.4353991	-103.8357052	-102.1969988	-100.5244246	-98.82264795	-97.09583886	-95.34767955	-93.58138859	-91.79975543	-90.00518039	-88.19971666	-86.38511179	-84.56284697	-82.73417327	-80.90014437	-79.06164552	-77.21941903	-75.37408623	-73.52616653	-71.67609361	-69.82422922	-67.97087487	-66.11628171	-64.2606588	-62.40418011	-60.54699033	-58.68920977	-56.83093845	-54.9722595	-53.11324198	-51.2539433	-49.39441111	-47.53468502	-45.67479793	-43.81477713	-41.95464533	-40.09442136	-38.23412085	-36.3737568	-34.51334	-32.65287939	-30.79238242	-28.93185525	-27.07130302	-25.21072997	-23.35013965	-21.48953498	-19.6289184	-17.76829193	-15.90765725	-14.04701575	-12.1863686	-10.32571675	-8.465061	-6.604402012	-4.743740334	-2.883076426	-1.022410664	0.838256637	2.698925214	4.559594852	6.42026537	8.280936619	10.14160847	12.00228083	13.86295361	5.710593137	6.263138419	6.868209147	7.530501541	8.255037943	9.047159085	9.912504506	10.85697727	11.88668833	13.00787521	14.2267888	15.54954204	16.98191408	18.52910506	20.19543874	21.9840148	23.89631907	25.93180859	28.08749925	30.35759483	32.733206	35.20221239	37.74931778	40.35633408	43.00270474	45.66624502	48.32404155	50.95342594	53.53292333	56.04308147	58.46710764	60.79127294	63.00507873	65.10120969	67.07531763	68.92568901	70.65284775	72.25913741	73.7483161	75.12518618	76.39527119	77.56454465	78.63921002	79.62552791	80.52968454	81.35769537	82.11533726	82.80810366	83.44117774	84.01941915	84.54736097	85.02921416	85.46887722	85.86994927	86.23574557	86.56931407	86.87345272	87.15072662	87.40348496	87.63387728	87.84386905	88.03525635	88.20967964	88.36863664	88.51349427	88.64549975	88.76579078	88.875405	88.97528858	89.06630422	89.14923839	89.22480803	89.29366663	89.35640981	89.4135804	89.46567313	89.51313886	89.55638845	89.59579631	89.63170361	89.66442126	89.69423256	89.72139565	89.74614575	89.76869721	89.78924531	89.80796803	89.82502751	89.8405715	89.85473463	89.86763955	89.87939805	89.89011197	89.8998741	89.90876899	89.91687369	89.9242584	89.93098706	89.93711798	89.94270424];
% 
% % 0.7	1	1	1	1	BL	SC
% z_BL_SC = [-124.1926587	-124.1724313	-124.1481215	-124.1189185	-124.0838563	-124.0417862	-123.9913466	-123.9309278	-123.8586344	-123.772245	-123.66917	-123.5464099	-123.4005183	-123.2275712	-123.0231506	-122.7823475	-122.4997934	-122.1697268	-121.7861034	-121.3427534	-120.8335868	-120.2528403	-119.5953496	-118.8568281	-118.03412	-117.1254013	-116.1303009	-115.0499258	-113.8867864	-112.6446331	-111.3282253	-109.9430618	-108.4951021	-106.9905046	-105.4353991	-103.8357052	-102.1969988	-100.5244246	-98.82264795	-97.09583886	-95.34767955	-93.58138859	-91.79975543	-90.00518039	-88.19971666	-86.38511179	-84.56284697	-82.73417327	-80.90014437	-79.06164552	-77.21941903	-75.37408623	-73.52616653	-71.67609361	-69.82422922	-67.97087487	-66.11628171	-64.2606588	-62.40418011	-60.54699033	-58.68920977	-56.83093845	-54.9722595	-53.11324198	-51.2539433	-49.39441111	-47.53468502	-45.67479793	-43.81477713	-41.95464533	-40.09442136	-38.23412085	-36.3737568	-34.51334	-32.65287939	-30.79238242	-28.93185525	-27.07130302	-25.21072997	-23.35013965	-21.48953498	-19.6289184	-17.76829193	-15.90765725	-14.04701575	-12.1863686	-10.32571675	-8.465061	-6.604402012	-4.743740334	-2.883076426	-1.022410664	0.838256637	2.698925214	4.559594852	6.42026537	8.280936619	10.14160847	12.00228083	13.86295361	5.710593137	6.263138419	6.868209147	7.530501541	8.255037943	9.047159085	9.912504506	10.85697727	11.88668833	13.00787521	14.2267888	15.54954204	16.98191408	18.52910506	20.19543874	21.9840148	23.89631907	25.93180859	28.08749925	30.35759483	32.733206	35.20221239	37.74931778	40.35633408	43.00270474	45.66624502	48.32404155	50.95342594	53.53292333	56.04308147	58.46710764	60.79127294	63.00507873	65.10120969	67.07531763	68.92568901	70.65284775	72.25913741	73.7483161	75.12518618	76.39527119	77.56454465	78.63921002	79.62552791	80.52968454	81.35769537	82.11533726	82.80810366	83.44117774	84.01941915	84.54736097	85.02921416	85.46887722	85.86994927	86.23574557	86.56931407	86.87345272	87.15072662	87.40348496	87.63387728	87.84386905	88.03525635	88.20967964	88.36863664	88.51349427	88.64549975	88.76579078	88.875405	88.97528858	89.06630422	89.14923839	89.22480803	89.29366663	89.35640981	89.4135804	89.46567313	89.51313886	89.55638845	89.59579631	89.63170361	89.66442126	89.69423256	89.72139565	89.74614575	89.76869721	89.78924531	89.80796803	89.82502751	89.8405715	89.85473463	89.86763955	89.87939805	89.89011197	89.8998741	89.90876899	89.91687369	89.9242584	89.93098706	89.93711798	89.94270424];
% % 0.7	1	1	1	1	BL	OC
% z_BL_OC = [0.11964511	0.119645862	0.119646768	0.119647859	0.119649173	0.119650755	0.119652662	0.119654958	0.119657724	0.119661055	0.119665068	0.119669901	0.119675723	0.119682735	0.119691182	0.119701355	0.119713609	0.119728369	0.119746148	0.119767562	0.119793356	0.119824424	0.119861846	0.119906921	0.119961213	0.120026608	0.120105376	0.120200251	0.120314527	0.120452171	0.120617962	0.120817654	0.121058178	0.121347883	0.121696822	0.122117104	0.122623312	0.123233007	0.123967337	0.124851769	0.125916967	0.127199851	0.128744871	0.130605536	0.132846254	0.13554454	0.138793669	0.142705855	0.147416067	0.153086589	0.159912486	0.168128123	0.178014933	0.189910668	0.20422036	0.221429293	0.242118272	0.266981526	0.296847559	0.332703278	0.375721622	0.427292868	0.489059568	0.562954784	0.651242893	0.756561614	0.881963133	1.030951174	1.207509708	1.41611762	1.661742456	1.949805388	2.286109402	2.676723719	3.12782027	3.645462881	4.235356603	4.902572638	5.651272009	6.484456534	7.403776742	8.409421819	9.500106795	10.67315877	11.92469018	13.24983603	14.64302616	16.09826304	17.60938049	19.17026567	20.77503494	22.41816138	24.09455724	25.79961754	27.52923291	29.27977953	31.04809347	32.83143521	34.62744925	36.43412208	0.034741969	0.038129268	0.041846823	0.045926835	0.050404642	0.05531903	0.060712563	0.066631958	0.073128485	0.080258413	0.088083497	0.096671514	0.106096846	0.116441131	0.127793961	0.140253667	0.153928164	0.168935886	0.185406817	0.203483607	0.223322816	0.245096261	0.268992508	0.295218502	0.324001355	0.355590313	0.390258904	0.428307311	0.470064955	0.51589334	0.566189175	0.621387785	0.681966859	0.748450558	0.821414009	0.901488231	0.989365526	1.085805375	1.191640888	1.307785845	1.435242385	1.575109382	1.728591567	1.897009435	2.08180999	2.284578364	2.507050331	2.751125755	3.018882936	3.312593843	3.634740141	3.988029881	4.375414643	4.800106799	5.265596458	5.775667442	6.33441143	6.946239108	7.615886778	8.348416444	9.149206804	10.02393197	10.97852395	12.01911418	13.15194861	14.3832702	15.71916244	17.16534773	18.7269358	20.40811996	22.2118237	24.13930666	26.18974832	28.3598384	30.64341418	33.03119412	35.51066113	38.06614429	40.67913223	43.32882508	45.99289796	48.64841473	51.2728039	53.84479729	56.34523896	58.75769495	61.06882811	63.26853655	65.34988321	67.30886262	69.14405772	70.85623803	72.44794183	73.9230743	75.28654258	76.54393893	77.70127588	78.76477232	79.74068603	80.63518687];

%%
% input = z_S2_increase;
% input = z_S2_decrease;
% 
% input = z_L1_increase;
% input = z_L1_decrease;
% 
% input = z_L2_increase;
% input = z_L2_decrease;
regressor = trainedModelTree.predictFcn;
input = PV_power_increase;
health="healthy";

reg_out = regressor(input)

%%
% % Normalize Input Data points
% inputCLF1 = (input-mean_trainCLF1)./std_trainCLF1;

% % Stage-1: Classify the health status - healthy or faulty
% health = classifier_health(inputCLF1);

if health=="healthy"
    % Stage-2: Forecast loads at L1 and L2 and source at S2
    disp('[INFO]: The system is healthy!')
    % Normalize Input Data points
    inputReg = (input-mean_trainReg)./std_trainReg;
    reg_out = regressor(inputReg)'.*std_evalReg+mean_evalReg;
    fprintf('[Prediction]: %.4f\n', reg_out);
elseif health=="faulty"
    disp('[INFO]: The system is faulty!')
    % Stage-2: Classify the fault location - L1, L2 or S2
    inputCLF2 = (input-mean_trainCLF2)./std_trainCLF2;
    flocation = classifier_faultLoc(inputCLF2);
    fprintf('[Fault Location]: %s\n', string(flocation));
    
    % Stage-3: Classify the fault type - SC or OC
    ftype = classifier_faultType(inputCLF2);
    fprintf('[Fault Type]: %s\n', string(ftype));
end
%%
% %% ---------------------------- THE END ---------------------------------------
% 
% syms s d rc rL L C
% z_on = rc+(1/(s*C));
% z_off = (rc+(1/(s*C))*(rL+s*L))/((rc+(1/(s*C)))+(rL+s*L));
% z_eff = z_on*d+z_off*(1-d);
% pretty(collect(z_eff))
% %%
% z = ((s*rc+1/C)*(s+rL/L+(rc*d*(1-d))/L))/(s^2+(rc+rL+d*rc)/L+(1-d)^2/(L*C));
% pretty(expand(z))
% 
% %%
% syms s d rc rL L C
% z_pv_num = ((s*rc+1/C)*(s+rL/L+(rc*d*(1-d))/(L)));
% z_pv_den = s^2+(1/L)*(rc+rL-d*rc)*s+1/(L*C)*(1-d)^2;
% z_pv = z_pv_num/z_pv_den;
% 
% %% 
% % rc = 0; rL = 0; % for ideal boost converter
% rc = 0.05; rL = 10e-3;
% d = 0.6; L=120e-6; C=100e-6;
% y = subs(z_pv);
% pretty(collect(y))
% 
% [nf, df] = numden(y);
% tfn = sym2poly(nf);
% tfd = sym2poly(df);
% 
% sys = tf(tfn, tfd);
% bode(sys)
% 
% nyquist(sys)
% 
% %%
% syms zl1 zl2 zl3 zl4 zL1 zL2
% zpv = z_pv;
% za = 2*zl2+zL1;
% zb = 2*zl3+zpv;
% zc = 2*zl4+zL2;
% zeq = (za*zb*zc)/(za*zb+zb*zc+zc*za);
% z_net =2*zl1+zeq;
% 
% pretty(simplify(z_net))

